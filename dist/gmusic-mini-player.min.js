"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){b.exports={CLASS_NAMESPACE:"gmusic-mini-player"}},{}],2:[function(a,b,c){var d=".gmusic-mini-player #material-player-left-wrapper .now-playing-actions,.gmusic-mini-player body[controls] #mini-info,.gmusic-mini-player body[ready]:hover #mini-info{opacity:1!important}#embed-container,.gmusic-mini-player #mainContainer,.gmusic-mini-player #mini-info{overflow:hidden!important}.gmusic-mini-player,.gmusic-mini-player body{height:300px!important;width:300px!important}.gmusic-mini-player #player{min-width:280px!important;z-index:9999999!important;height:65px!important;min-height:65px!important;transition:bottom .3s!important;bottom:-100px!important;transition-timing-function:ease-in-out!important;width:280px!important;left:10px!important;right:10px!important;border-bottom-left-radius:8px!important;border-bottom-right-radius:8px!important}.gmusic-mini-player body[controls] #player,.gmusic-mini-player body[ready]:hover #player{bottom:-12px!important}.gmusic-mini-player #topBar{display:none!important}.gmusic-mini-player #material-player-left-wrapper .now-playing-info-content,.gmusic-mini-player #material-player-left-wrapper .player-left .image-wrapper,.gmusic-mini-player #material-player-left-wrapper [data-id=now-playing-menu],.gmusic-mini-player #material-player-right-wrapper{display:none!important}.gmusic-mini-player #material-player-left-wrapper{flex:none!important;width:0!important}.gmusic-mini-player #player #material-player-left-wrapper .rating-container paper-icon-button{background:0 0!important;position:absolute!important;top:8px!important}.gmusic-mini-player #player #material-player-left-wrapper .rating-container paper-icon-button:nth-child(1){left:20px!important;display:none!important}.gmusic-mini-player #player #material-player-left-wrapper .rating-container paper-icon-button:nth-child(2){left:210px!important;display:none!important}.gmusic-mini-player #player[radio] #material-player-left-wrapper .rating-container paper-icon-button:nth-child(1),.gmusic-mini-player #player[radio] #material-player-left-wrapper .rating-container paper-icon-button:nth-child(2){display:block!important}.gmusic-mini-player #material-player-left-wrapper .rating-container{width:0!important}.gmusic-mini-player #mini-album{position:fixed!important;top:0!important;left:0!important;display:block!important;width:100%!important;height:100%!important;z-index:9999998!important}.gmusic-mini-player .player-progress-wrapper{left:0!important}.gmusic-mini-player .material-player-middle{margin:0 auto!important}.gmusic-mini-player #player.material .material-player-middle paper-icon-button[data-id=play-pause] iron-icon,.gmusic-mini-player #player.material .material-player-middle sj-icon-button[data-id=play-pause] core-icon{height:50px!important;width:50px!important;top:-2px!important}.gmusic-mini-player paper-icon-button[data-id=play-pause]{text-align:center!important}.gmusic-mini-player [data-id=play-pause]::shadow paper-ripple.circle{height:50px!important;width:50px!important;margin-left:6px!important;margin-top:-2px!important}.gmusic-mini-player [data-id=forward],.gmusic-mini-player [data-id=repeat],.gmusic-mini-player [data-id=rewind],.gmusic-mini-player [data-id=shuffle]{top:-8px!important}.gmusic-mini-player .mini-timespan-c,.gmusic-mini-player .mini-timespan-t{position:absolute!important;top:8px!important;font-size:11px!important;display:block!important}.gmusic-mini-player [data-id=repeat]{left:28px!important}.gmusic-mini-player [data-id=rewind]{left:16px!important}.gmusic-mini-player [data-id=forward]{left:-16px!important}.gmusic-mini-player [data-id=shuffle]{left:-28px!important}.gmusic-mini-player .mini-timespan-c{left:6px!important}.gmusic-mini-player .mini-timespan-t{right:6px!important}.gmusic-mini-player ::shadow #mainContainer{overflow:hidden!important}.gmusic-mini-player #mini-info{position:fixed!important;top:0!important;left:0!important;width:100%!important;height:90px!important;background:-webkit-linear-gradient(top,rgba(45,45,45,.85) 0,rgba(9,9,9,.41) 79%,rgba(0,0,0,0) 100%)!important;display:block!important;z-index:9999999!important;transition:opacity .3s!important;transition-timing-function:ease-in-out!important;opacity:0!important}.gmusic-mini-player #mini-info span{color:#EEE!important;display:block!important;font-size:20px!important;padding:4px 12px!important;cursor:default!important}.gmusic-mini-player #mini-info span:last-child{font-size:16px!important;height:18px!important;overflow:hidden!important}[data-id=show-miniplayer-dp]{color:#9e9e9e!important;position:absolute!important;top:auto!important;bottom:-4px!important;right:-4px!important;margin:0!important}#player paper-icon-button[data-id=show-miniplayer-dp] iron-icon{width:16px!important;height:16px!important}#embed-container{width:0!important}",e=a("../lib/_constants"),f=function(){function a(){_classCallCheck(this,a),this.GPM_API=new window.GMusic(window),this.SELECTORS=window.GMusic.SELECTORS,this._initCSS(),this._initMiniPlayerUI(),this._initMiniPlayerNowPlayingMonitor(),this._initMiniPlayerTimingUI(),this._initMiniPlayerTimingMonitor(),this._initMiniPlayerRadioMonitor(),this.miniState=!1,this.scrollVolume=!0,this.events={},this._initGlobalEventHandlers()}return _createClass(a,[{key:"_initCSS",value:function(){var a=document.createElement("style");a.innerHTML=d,document.body.appendChild(a)}},{key:"_initMiniPlayerUI",value:function(){this.miniNowPlayerInfo=document.createElement("div"),this.miniAlbumArt=document.createElement("img"),this.miniNowPlayerInfo.id="mini-info",this.miniNowPlayerInfo.setAttribute("style","display: none"),this.miniNowPlayerInfo.innerHTML="<span></span><span></span>",this.miniAlbumArt.id="mini-album",this.miniAlbumArt.src="https://www.samuelattard.com/img/gpm_placeholder.jpg",this.miniAlbumArt.setAttribute("style","display: none"),this.miniAlbumArt.addEventListener("error",function(a){a.target.src="https://www.samuelattard.com/img/gpm_placeholder.jpg"}),this.miniAlbumArt.addEventListener("mousedown",function(a){a.preventDefault()}),document.body.appendChild(this.miniNowPlayerInfo),document.body.appendChild(this.miniAlbumArt)}},{key:"_initMiniPlayerTimingUI",value:function(){var a=this,b=document.getElementById("player"),c=document.createElement("div");this.timeSpan_SoFar=document.createElement("span"),this.timeSpan_Total=document.createElement("span"),this.timeSpan_SoFar.classList.add("mini-timespan-c"),this.timeSpan_SoFar.setAttribute("style","display: none"),this.timeSpan_SoFar.innerHTML="0:00",b.appendChild(this.timeSpan_SoFar),this.timeSpan_Total.classList.add("mini-timespan-t"),this.timeSpan_Total.setAttribute("style","display: none"),this.timeSpan_Total.innerHTML="0:00",b.appendChild(this.timeSpan_Total),c.innerHTML='\n      <paper-icon-button\n        data-id="show-miniplayer-dp"\n        icon="open-in-new"\n        title="Show mini player"\n        aria-label="Show mini player"\n        role="button"\n        tabindex="0"\n        no-focus="">\n      </paper-icon-button>',this.miniButtonElement=c.querySelectorAll('[data-id="show-miniplayer-dp"]')[0],this.miniButtonElement.addEventListener("click",function(b){return a.getControls().toggle(),b.target.blur(),a.miniButtonElement.style.display="none",document.body.removeAttribute("ready"),setTimeout(function(){a.miniButtonElement.style.display="block"},400),b.preventDefault(),!1}),document.getElementById("player").appendChild(c)}},{key:"_initMiniPlayerTimingMonitor",value:function(){var a=this;this.GPM_API.on("change:playback-time",function(b){a.timeSpan_SoFar.innerHTML=b.current?a._timeFormat(b.current):"0:00",a.timeSpan_Total.innerHTML=b.total?a._timeFormat(b.total):"0:00"})}},{key:"_initMiniPlayerRadioMonitor",value:function(){this.GPM_API.on("change:playback",this._radioMonitor.bind(this)),this.GPM_API.on("change:playback-time",this._radioMonitor.bind(this)),this.GPM_API.on("change:song",this._radioMonitor.bind(this))}},{key:"_radioMonitor",value:function(){var a=document.querySelectorAll(this.SELECTORS.repeat.buttonSelector),b=document.querySelector("#player");a&&a[0]&&b&&("none"===a[0].style.display?null===b.getAttribute("radio")&&b.setAttribute("radio","on"):null!==b.getAttribute("radio")&&b.removeAttribute("radio"))}},{key:"_initMiniPlayerNowPlayingMonitor",value:function(){var a=this;this.GPM_API.on("change:song",function(b){a.miniAlbumArt.src=b.art.replace("=s90","=s300");var c=a.miniNowPlayerInfo.getElementsByTagName("span");c[0].innerHTML=b.title,c[1].innerHTML=b.artist+" - "+b.album})}},{key:"_initGlobalEventHandlers",value:function(){var a=this;window.addEventListener("mousewheel",function(b){a.scrollVolume&&a.miniState&&(b.wheelDelta<0?a.GPM_API.volume.decreaseVolume():a.GPM_API.volume.increaseVolume())}),document.body.addEventListener("mousemove",function(){a.miniState&&"none"!==a.miniButtonElement.style.display&&document.body.setAttribute("ready","ready")}),document.addEventListener("mousedown",function(b){return a.miniState&&b.clientY<=210?(a._fire("dragstart"),b.preventDefault(),b.stopPropagation(),!1):void 0})}}]),_createClass(a,[{key:"_timeFormat",value:function(a){var b=Math.floor(a/1e3),c=Math.floor(b/60),d=b%60;return c+":"+(10>d?"0"+d:d)}},{key:"_hook",value:function(a,b){this.events[a]=this.events[a]||[],this.events[a].push(b)}},{key:"_fire",value:function(a,b){this.events[a]=this.events[a]||[],this.events[a].forEach(function(a){a(b)})}},{key:"getControls",value:function(){var a=this;return{enable:function(){a._enable()},disable:function(){a._disable()},toggle:function(){a.miniState?a._disable():a._enable()},enableButton:function(){a._enableButton()},disableButton:function(){a._disableButton()},showControlsWhen:function(b){a._showControlsWhen(b)},setScrollVolume:function(b){a.scrollVolume=b},getScrollVolume:function(){return a.scrollVolume},on:function(b,c){a._hook(b,c)}}}},{key:"_enable",value:function(){var a=0;this.miniState=!0;var b=document.getElementById("left-nav-close-button");null!==b&&b.click(),this._fire("enable",function(b){a=b}),setTimeout(function(){document.querySelector("html").classList.add(e.CLASS_NAMESPACE)},a)}},{key:"_disable",value:function(){var a=0;this.miniState=!1,this._fire("disable",function(b){a=b}),setTimeout(function(){document.querySelector("html").classList.remove(e.CLASS_NAMESPACE)},a)}},{key:"_enableButton",value:function(){this.miniButtonElement.style.display="block"}},{key:"_disableButton",value:function(){this.miniButtonElement.style.display="none"}},{key:"_showControlsWhen",value:function(a){"hover"===a?document.body.removeAttribute("controls"):document.body.setAttribute("controls","controls")}}]),a}();if(window.GMusic){var g=new f;window.GMusic._protoObj.mini=g.getControls()}else console.error("The core GMusic library must be included for the GMusic mini player library to work")},{"../lib/_constants":1}]},{},[2]);